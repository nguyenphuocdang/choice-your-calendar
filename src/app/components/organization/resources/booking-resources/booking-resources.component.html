<div class="container" (dblclick)="closeBookingSidenav()">
    <div class="booking-resource">
        <mat-card>
            <mat-card-content>
                <div class="header">
                    <span>
                        Booking Resources Dashboard
                    </span>
                </div>
                <div class="booking-info">
                    <mat-card>
                        <mat-card-content>
                            <!-- <div class="check">
                                <mat-checkbox></mat-checkbox>
                            </div> -->
                            <div class="resource-type select">
                                <span>Resource Type</span>
                                <mat-form-field appearance="fill">
                                    <mat-label>
                                        Select type
                                    </mat-label>
                                    <mat-select multiple (selectionChange)="onResourceTypeSelectChangeAction($event)"
                                        [formControl]="selectedResourceTypeFormControl">
                                        <mat-select-trigger>
                                            <span>
                                                {{selectedResourceTypeFormControl.value?.[0]}}
                                            </span>
                                            <span *ngIf="(selectedResourceTypeFormControl.value?.length || 0) > 1"
                                                class="additional-selection">
                                                (+{{(selectedResourceTypeFormControl.value?.length || 0) - 1}}
                                                {{selectedResourceTypeFormControl.value?.length === 2 ? 'other' :
                                                'others'}})
                                            </span>
                                        </mat-select-trigger>
                                        <ng-container>
                                            <mat-option *ngFor="let type of resourceType" [value]="type.label">
                                                {{type.label}}
                                                <span>
                                                    <mat-icon *ngIf="type.value =='ROOM'" style="color: #23a669">
                                                        place</mat-icon>
                                                    <mat-icon *ngIf="type.value =='DEVICE'"
                                                        style="color: #23a669">computer</mat-icon>
                                                    <mat-icon *ngIf="type.value=='PERSON'"
                                                        style="color: #23a669">people</mat-icon>
                                                </span>
                                            </mat-option>
                                        </ng-container>
                                    </mat-select>
                                </mat-form-field>
                            </div>

                            <div class="resource-list select">
                                <span>Resource Option</span>
                                <mat-form-field appearance="fill">
                                    <mat-label>Select an option</mat-label>
                                    <mat-select multiple (selectionChange)="onResourceSelectionChangeAction($event)"
                                        [formControl]="selectedResourceFormControl">
                                        <mat-select-trigger>
                                            <span>
                                                {{(selectedResourceFormControl.value?.[0].deviceType != null)
                                                ?selectedResourceFormControl.value?.[0].name :
                                                selectedResourceFormControl.value?.[0].fullname}}
                                            </span>
                                            <span *ngIf="selectedResourceFormControl.value?.length > 1">
                                                , {{(selectedResourceFormControl.value?.[1].deviceType != null)
                                                ?selectedResourceFormControl.value?.[1].name :
                                                selectedResourceFormControl.value?.[1].fullname}}
                                            </span>
                                            <span *ngIf="(selectedResourceFormControl.value?.length || 0) > 2"
                                                class="additional-selection" matTooltipTrigger="hover"
                                                matTooltipPosition="right" [matTooltip]="tooltipSelectedResources"
                                                [matTooltipClass]="{'mat-tooltip-style': true}">
                                                (+{{(selectedResourceFormControl.value?.length || 0) - 2}}
                                                {{selectedResourceFormControl.value?.length === 3 ? 'other' :
                                                'others'}})
                                            </span>
                                        </mat-select-trigger>
                                        <ng-container>
                                            <div class="resource-content"
                                                [ngClass]="{'border-bottom-line': isSelectRoom}">
                                                <ng-container *ngIf="isSelectRoom">
                                                    <div class="resource-list-type-header">
                                                        <mat-icon> place</mat-icon>
                                                        <span>Room</span>
                                                    </div>
                                                    <div class="grid-container">
                                                        <mat-option *ngFor="let element of selectedResourceRoom"
                                                            [value]="element">
                                                            <span class="grid-element">{{element.name}}</span>
                                                        </mat-option>
                                                    </div>
                                                </ng-container>
                                            </div>
                                            <div class="resource-content"
                                                [ngClass]="{'border-bottom-line': isSelectDevice}">
                                                <ng-container *ngIf="isSelectDevice">
                                                    <div class="resource-list-type-header">
                                                        <mat-icon>computer</mat-icon>
                                                        <span>Support Device</span>
                                                    </div>
                                                    <div class="grid-container">
                                                        <mat-option *ngFor="let element of selectedResourceDevice"
                                                            [value]="element">
                                                            <span class="grid-element">{{element.name}}</span>
                                                        </mat-option>
                                                    </div>
                                                </ng-container>
                                            </div>
                                            <div class="resource-content"
                                                [ngClass]="{'border-bottom-line': isSelectPeople}">
                                                <ng-container *ngIf="isSelectPeople">
                                                    <div class="resource-list-type-header">
                                                        <mat-icon>people</mat-icon>
                                                        <span>People</span>
                                                    </div>
                                                    <div class="grid-container">
                                                        <mat-option *ngFor="let element of selectedResourcePeople"
                                                            [value]="element">
                                                            <span class="grid-element">{{element.fullname}}</span>
                                                        </mat-option>
                                                    </div>
                                                </ng-container>
                                            </div>
                                        </ng-container>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="schedule-button">
                                <button mat-raised-button class="book" (click)="triggerBookingSidenav()">
                                    <mat-icon>today</mat-icon>
                                    Schedule
                                </button>
                            </div>
                        </mat-card-content>
                    </mat-card>
                </div>
                <div class="event">
                    <mat-card>
                        <mat-card-content>
                            <div class="event-data">
                                <mat-tab-group [dynamicHeight]="true">
                                    <mat-tab label="Upcoming Booking Events">
                                        <div *ngIf="upcomingEvents.length === 0" class='unavailable-event'>
                                            <span>No Upcoming Booking Event Found</span>
                                            <img src="assets/images/no-event.png" class="image">
                                        </div>
                                    </mat-tab>
                                    <mat-tab label="Pending Booking Events">
                                        <div *ngIf="pendingEvents.length === 0" class='unavailable-event'>
                                            <span>No Pending Booking Event Found</span>
                                            <img src="assets/images/no-event.png" class="image">
                                        </div>
                                    </mat-tab>
                                    <mat-tab label="Cancel Booking Events">
                                        <div *ngIf="cancelEvents.length === 0" class='unavailable-event'>
                                            <span>No Cancel Booking Event Found</span>
                                            <img src="assets/images/no-event.png" class="image">
                                        </div>
                                    </mat-tab>
                                    <mat-tab label="All Booking Events">
                                        <div *ngIf="previousEvents.length === 0; else hasEvents"
                                            class='unavailable-event'>
                                            <span>No Booking Event Found</span>
                                            <img src="assets/images/no-event.png" class="image">
                                        </div>
                                        <ng-template #hasEvents>
                                            <div class="event-grid-container">
                                                <div class="event-card" *ngFor="let event of previousEvents">
                                                    <mat-card>
                                                        <mat-card-content appMaterialElevation>
                                                            <img src="https://res.cloudinary.com/dzri3e9wa/image/upload/v1682823938/event-image/event-image_pmj0ye.jpg?fbclid=IwAR21IoqQ2Nrl6_Nqd2wFOGChCilHpTAg24mWhM-Bt2lFlY5IrahvPajz73w"
                                                                alt="" *ngIf="event.appointmentUrl != ''">
                                                            <img src="https://res.cloudinary.com/dzri3e9wa/image/upload/v1683194746/website-image/interview_ll0mzx.jpg"
                                                                alt="" *ngIf="event.appointmentUrl == ''">
                                                            <span class="date">
                                                                <mat-icon style="color: #23a669;;">date_range</mat-icon>
                                                                {{event.date}}
                                                            </span>
                                                            <span class="time">
                                                                <mat-icon style="color:#23a669;">alarm</mat-icon>
                                                                {{event.time}}
                                                            </span>
                                                            <span class="title">
                                                                {{event.eventName}}
                                                            </span>
                                                            <span class="status" *ngIf="event.appointmentUrl != ''">
                                                                <mat-icon
                                                                    style="color: #00705a;;">check_circle</mat-icon>
                                                                Online
                                                            </span>
                                                            <span class="status" *ngIf="event.appointmentUrl == ''">
                                                                <mat-icon
                                                                    style="color: rgb(204, 4, 4);">check_circle</mat-icon>
                                                                Offline
                                                            </span>
                                                        </mat-card-content>
                                                    </mat-card>
                                                </div>
                                            </div>
                                        </ng-template>

                                    </mat-tab>
                                </mat-tab-group>
                            </div>
                        </mat-card-content>
                    </mat-card>
                </div>
                <div class="booking-sidenav">
                    <mat-sidenav-container #sidenavContainer>
                        <mat-sidenav #sidenav position="end" [opened]="isShowingBookSidenav">
                            <div class="selected-day" *ngIf="weekdays.length > 0">
                                {{weekdays[indexSelectedWeekday].code}}, {{weekdays[indexSelectedWeekday].date_ddmmyy}}
                            </div>
                            <div class="weekday">
                                <div class='day' *ngFor="let day of weekdays, let index = index">
                                    <button mat-raised-button (click)="dateSelect(index)"
                                        [ngClass]="{'date-click-event': day.selectFlag}">
                                        <span class="button-day">
                                            {{day.day}}
                                        </span>
                                        <span class="button-weekday">
                                            {{day.code}}
                                        </span>
                                    </button>
                                </div>
                            </div>

                            <div class="booking-resource-info">
                                <form action="" name="makeEventForm" [formGroup]="makeEventForm">
                                    <div class="row1 event-name">
                                        <label for="event-name">Event Name</label>
                                        <input type="text" formControlName="eventName">
                                    </div>
                                    <div class="row2">
                                        <div>
                                            <span>
                                                Event Duration
                                            </span>
                                            <mat-form-field appearance="fill">
                                                <mat-select formControlName='eventDuration'
                                                    (selectionChange)="onSelectionChangeEventDuration()">
                                                    <mat-option value="30 minutes">
                                                        30 minutes
                                                    </mat-option>
                                                    <mat-option value="60 minutes">
                                                        60 minutes
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>
                                        <div>
                                            <span>Event Type</span>
                                            <mat-form-field appearance="fill">
                                                <mat-select formControlName='eventType'>
                                                    <mat-option value="Offline">
                                                        Offline
                                                    </mat-option>
                                                    <mat-option value="Online">
                                                        Online
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>
                                    </div>
                                </form>


                            </div>
                            <div class="booking-slot">
                                <span style="font-weight: 500; font-size: medium; padding:3% !important">
                                    Booking Slots Available
                                </span>
                                <div class="slots-grid-container">
                                    <div class="slots-card" *ngFor="let slot of bookingSlots, let index = index">
                                        <mat-card>
                                            <mat-card-content [ngClass]="{'selected-booking-slot': slot.selectFlag}"
                                                (click)="onSelectBookingSlotClicked(index)">
                                                <span>
                                                    {{slot.timeDatas.startTime}} - {{slot.timeDatas.endTime}}
                                                </span>
                                            </mat-card-content>
                                        </mat-card>
                                    </div>
                                </div>
                                <div class="unavailable" *ngIf="bookingSlots.length == 0">
                                    NO SLOTS AVAILABLE
                                </div>
                            </div>
                        </mat-sidenav>
                    </mat-sidenav-container>
                </div>

                <div class="confirm-booking-sidenav">
                    <mat-sidenav-container>
                        <mat-sidenav #sidenav [opened]="isShowingConfirmBookSidenav">
                            <!-- content goes here -->
                        </mat-sidenav>
                        <mat-sidenav-content>
                            <!-- content goes here -->
                        </mat-sidenav-content>
                    </mat-sidenav-container>
                </div>

            </mat-card-content>
        </mat-card>
    </div>
</div>